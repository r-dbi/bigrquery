<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Download table data — bq_table_download • bigrquery</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Download table data — bq_table_download"><meta name="description" content="This function provides two ways to download data from BigQuery, transfering
data using either JSON or arrow, depending on the api argument. If
bigrquerystorage is installed, api = &quot;arrow&quot; will be used (because it's
so much faster, but see the limitions below), otherwise you can select
deliberately by using api = &quot;json&quot; or api = &quot;arrow&quot;.
Arrow API


The arrow API is much faster, but has heavier dependencies: bigrquerystorage
requires the arrow package, which can be tricky to compile on Linux (but you
usually should be able to get a binary from
Posit Public Package Manager.
There's one known limitation of api = &quot;arrow&quot;: when querying public data,
you'll now need to provide a billing project.



JSON API


The JSON API retrieves rows in chunks of page_size. It is most suitable
for results of smaller queries (&amp;lt;100 MB, say). Unfortunately due to
limitations in the BigQuery API, you may need to vary this parameter
depending on the complexity of the underlying data.
The JSON API will convert nested and repeated columns in to list-columns
as follows:
Repeated values (arrays) will become a list-column of vectors.
Records will become list-columns of named lists.
Repeated records will become list-columns of data frames.



"><meta property="og:description" content="This function provides two ways to download data from BigQuery, transfering
data using either JSON or arrow, depending on the api argument. If
bigrquerystorage is installed, api = &quot;arrow&quot; will be used (because it's
so much faster, but see the limitions below), otherwise you can select
deliberately by using api = &quot;json&quot; or api = &quot;arrow&quot;.
Arrow API


The arrow API is much faster, but has heavier dependencies: bigrquerystorage
requires the arrow package, which can be tricky to compile on Linux (but you
usually should be able to get a binary from
Posit Public Package Manager.
There's one known limitation of api = &quot;arrow&quot;: when querying public data,
you'll now need to provide a billing project.



JSON API


The JSON API retrieves rows in chunks of page_size. It is most suitable
for results of smaller queries (&amp;lt;100 MB, say). Unfortunately due to
limitations in the BigQuery API, you may need to vary this parameter
depending on the complexity of the underlying data.
The JSON API will convert nested and repeated columns in to list-columns
as follows:
Repeated values (arrays) will become a list-column of vectors.
Records will become list-columns of named lists.
Repeated records will become list-columns of data frames.



"><meta name="robots" content="noindex"><script defer data-domain="bigrquery.r-dbi.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bigrquery</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.6.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2024/01/bigrquery-1-5-0/">bigrquery 1.5.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2021/08/bigrquery-1-4-0/">bigrquery 1.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2019/02/bigrquery-1-1-0/">bigrquery 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2018/04/bigrquery-1-0-0/">bigrquery 1.0.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-dbi/bigrquery/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Download table data</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-dbi/bigrquery/blob/main/R/bq-download.R" class="external-link"><code>R/bq-download.R</code></a></small>
      <div class="d-none name"><code>bq_table_download.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function provides two ways to download data from BigQuery, transfering
data using either JSON or arrow, depending on the <code>api</code> argument. If
bigrquerystorage is installed, <code>api = "arrow"</code> will be used (because it's
so much faster, but see the limitions below), otherwise you can select
deliberately by using <code>api = "json"</code> or <code>api = "arrow"</code>.</p><div class="section">
<h3 id="arrow-api">Arrow API<a class="anchor" aria-label="anchor" href="#arrow-api"></a></h3>


<p>The arrow API is much faster, but has heavier dependencies: bigrquerystorage
requires the arrow package, which can be tricky to compile on Linux (but you
usually should be able to get a binary from
<a href="https://p3m.dev/" class="external-link">Posit Public Package Manager</a>.</p>
<p>There's one known limitation of <code>api = "arrow"</code>: when querying public data,
you'll now need to provide a <code>billing</code> project.</p>
</div>

<div class="section">
<h3 id="json-api">JSON API<a class="anchor" aria-label="anchor" href="#json-api"></a></h3>


<p>The JSON API retrieves rows in chunks of <code>page_size</code>. It is most suitable
for results of smaller queries (&lt;100 MB, say). Unfortunately due to
limitations in the BigQuery API, you may need to vary this parameter
depending on the complexity of the underlying data.</p>
<p>The JSON API will convert nested and repeated columns in to list-columns
as follows:</p><ul><li><p>Repeated values (arrays) will become a list-column of vectors.</p></li>
<li><p>Records will become list-columns of named lists.</p></li>
<li><p>Repeated records will become list-columns of data frames.</p></li>
</ul></div>

    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bq_table_download</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  n_max <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  page_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start_index <span class="op">=</span> <span class="fl">0L</span>,</span>
<span>  max_connections <span class="op">=</span> <span class="fl">6L</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  bigint <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"integer"</span>, <span class="st">"integer64"</span>, <span class="st">"numeric"</span>, <span class="st">"character"</span><span class="op">)</span>,</span>
<span>  api <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"json"</span>, <span class="st">"arrow"</span><span class="op">)</span>,</span>
<span>  billing <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">project</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A <a href="bq_refs.html">bq_table</a></p></dd>


<dt id="arg-n-max">n_max<a class="anchor" aria-label="anchor" href="#arg-n-max"></a></dt>
<dd><p>Maximum number of results to retrieve. Use <code>Inf</code> to retrieve all
rows.</p></dd>


<dt id="arg-page-size">page_size<a class="anchor" aria-label="anchor" href="#arg-page-size"></a></dt>
<dd><p>(JSON only) The number of rows requested per chunk. It is
recommended to leave this unspecified until you have evidence that the
<code>page_size</code> selected automatically by <code>bq_table_download()</code> is problematic.</p>
<p>When <code>page_size = NULL</code> bigrquery determines a conservative, natural chunk
size empirically. If you specify the <code>page_size</code>, it is important that each
chunk fits on one page, i.e. that the requested row limit is low enough to
prevent the API from paginating based on response size.</p></dd>


<dt id="arg-start-index">start_index<a class="anchor" aria-label="anchor" href="#arg-start-index"></a></dt>
<dd><p>(JSON only) Starting row index (zero-based).</p></dd>


<dt id="arg-max-connections">max_connections<a class="anchor" aria-label="anchor" href="#arg-max-connections"></a></dt>
<dd><p>(JSON only) Number of maximum simultaneous
connections to BigQuery servers.</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>If <code>FALSE</code>, displays progress bar; if <code>TRUE</code> is silent;
if <code>NA</code> picks based on whether or not you're in an interactive context.</p></dd>


<dt id="arg-bigint">bigint<a class="anchor" aria-label="anchor" href="#arg-bigint"></a></dt>
<dd><p>The R type that BigQuery's 64-bit integer types should be
mapped to. The default is <code>"integer"</code>, which returns R's <code>integer</code> type,
but results in <code>NA</code> for values above/below +/- 2147483647. <code>"integer64"</code>
returns a <a href="https://rdrr.io/pkg/bit64/man/bit64-package.html" class="external-link">bit64::integer64</a>, which allows the full range of 64 bit
integers.</p></dd>


<dt id="arg-api">api<a class="anchor" aria-label="anchor" href="#arg-api"></a></dt>
<dd><p>Which API to use? The <code>"json"</code> API works where ever bigrquery
does, but is slow and can require fiddling with the <code>page_size</code> parameter.
The <code>"arrow"</code> API is faster and more reliable, but only works if you
have also installed the bigrquerystorage package.</p>
<p>Because the <code>"arrow"</code> API is so much faster, it will be used automatically
if the bigrquerystorage package is installed.</p></dd>


<dt id="arg-billing">billing<a class="anchor" aria-label="anchor" href="#arg-billing"></a></dt>
<dd><p>(Arrow only) Project to bill; defaults to the project of <code>x</code>,
and typically only needs to be specified if you're working with public
datasets.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Because data retrieval may generate list-columns and the <code>data.frame</code>
print method can have problems with list-columns, this method returns
a tibble. If you need a <code>data.frame</code>, coerce the results with
<code><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="google-bigquery-api-documentation">Google BigQuery API documentation<a class="anchor" aria-label="anchor" href="#google-bigquery-api-documentation"></a></h2>


<ul><li><p><a href="https://cloud.google.com/bigquery/docs/reference/rest/v2/tabledata/list" class="external-link">list</a></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># bq_testable()</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">bq_table_download</span><span class="op">(</span><span class="st">"publicdata.samples.natality"</span>, n_max <span class="op">=</span> <span class="fl">35000</span>, billing <span class="op">=</span> <span class="fu"><a href="bq_test_project.html">bq_test_project</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://jennybryan.org" class="external-link">Jennifer Bryan</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer></body></html>

